<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Manager</title>
    <link rel="stylesheet" href="style.css">
    <script src="js/dummydata.js"></script>
    <script src="js/data.js"></script>
    <script src="js/templates.js"></script>
</head>

<body onload="init()">
    <div onclick="closeOverlay()" id="overlay" class="overlay d-none"></div>

    <header>
        <h1>Document Manager</h1>
        <nav id="breadcrumb">Root</nav>
    </header>

    <main id="main">
        <section class="sectionControls">
            <div class="flexColumn">
                <label for="searchInput">Separate search terms by a comma.</label>
                <input oninput="searchAll()" id="searchInput" placeholder="Search for document or categories..." />
            </div>

            <div>
                <input id="savePermanently" onclick="changeStorage()" class="checkbox" type="checkbox">
                <label for="savePermanently">Save permanently</label>
                <input id="useDummyData" onclick="checkForDummyData()" class="checkbox" type="checkbox" checked>
                <label for="useDummyData">Use dummy data</label>
                <button id="btnImportAPI" onclick="toggleSectionVisibility('APIKey')">API Key</button>
                <button id="btnNewCategory" onclick="toggleSectionVisibility('addCategorie')">NewCategory</button>
                <button id="btnAddFiles" onclick="toggleSectionVisibility('addDoc')">Add Image(s)</button>
            </div>
        </section>

        <section class="sectionTable">
            <h2><span>
                    <nav id="breadcrumbInH2">Root</nav>
                </span> Categories</h2>

            <table id="categoriesTable">
                <thead>
                    <tr>
                        <th onclick="sortCategoriesBy('name')">Category</th>
                        <th onclick="sortCategoriesBy('updatedAt')">Last change</th>
                        <th onclick="sortCategoriesBy('createdAt')">Created at</th>
                        <th onclick="sortCategoriesBy('subCount')">Sub categories</th>
                        <th onclick="sortCategoriesBy('id')">Documents total</th>
                    </tr>
                </thead>
                <tbody id="categoriesBody"></tbody>
            </table>

            <h2>Files</h2>
            <table id="filesTable" hidden>
                <thead>
                    <tr>
                        <th onclick="sortFilesBy('name')">Filename</th>
                        <th onclick="sortFilesBy('createdAt')">Created</th>
                        <th onclick="sortFilesBy('docDate')">File Date</th>
                        <th onclick="sortFilesBy('text')">Extracted Text</th>
                    </tr>
                </thead>
                <tbody id="filesBody"></tbody>
            </table>

            <div id="infoBox" class="info-box">
                <p>Select a category to see subcategories and documents.</p>
            </div>
        </section>

        <section class="flexColumn g24">
            <div>
                <h2>Document Details</h2>
                <div id="detailBtnBox" class="flex"></div>
            </div>
            <div id="findByBox" class="d-none">
                <h3>Find by</h3>
                <div id="searchValues" class="flex"></div>
            </div>
            <div id="fileContent"></div>
        </section>

        <!-- Popup sections -->

        <section id="addDoc" class="popupSection addDocSection d-none">
            <form class="addDocForm" onsubmit="processAllFiles(); return false;">
                <h2>Add New Document</h2>

                <div class="flexColumn">
                    <label for="docNameInput">Document name:</label>
                    <input id="docNameInput" placeholder="Document Name" required>
                </div>

                <div class="flexColumn">
                    <label for="docDateInput">Document date:</label>
                    <input id="docDateInput" type="date" required>
                </div>

                <div class="flexColumn">
                    <label for="docCategorySelect">Select category:</label>
                    <select id="docCategorySelect">
                        <!-- dynamic category options -->
                    </select>
                </div>

                <div class="flexColumn">
                    <label for="fileInput">Select image file(s):</label>
                    <input id="fileInput" type="file" accept="image/*" multiple>
                </div>

                <div class="flexColumn">
                    <label for="inputSearchValues">your search terms separated by a comma:</label>
                    <input id="inputSearchValues" type="text">
                </div>

                <button id="addDocSubmitBtn" type="submit">Add Document</button>

            </form>
        </section>

        <section id="addCategorie" class="popupSection addCategorieSection d-none">
            <h2>Add new Category</h2>
            <form onsubmit="addCategorie(); return false;">
                <div class="flexColumn">
                    <label for="catNameInput">Category name:</label>
                    <input id="catNameInput" type="text">
                </div>

                <div class="flexColumn">
                    <label for="catColorInput">Choose color:</label>
                    <input id="catColorInput" type="color">
                </div>

                <div class="flexColumn">
                    <label for="catParentSelect">Select parent category:</label>
                    <select id="catParentSelect">
                        <!-- dynamic category options -->
                    </select>
                </div>

                <button type="submit">Add Category</button>
            </form>
        </section>

        <section id="APIKey" class="popupSection APIKeySection d-none">
            <h2>Enter your API Key</h2>

            <a href="https://aistudio.google.com/apikey?hl=de" target="_blank">Get your API key here</a>

            <div>
                <label for="APIKeyInput"></label>
                <input id="APIKeyInput" type="password" placeholder="Your Google Gemini API Key">
            </div>

            <div>
                <p>Save your Google Gemini API key local:</p>
                <button id="btnSaveSession" onclick="saveKey()">Save</button>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <small>Â© Document Manager</small>
    </footer>

    <script src="js/ui.js"></script>
    <script src="js/script.js"></script>
</body>

</html>